
ğŸ“‹ ETL Configuration:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
{
  "database": {
    "connectionString": "Server=halo-sql.database.windows.net;Database=halo-sqldb;User Id=azadmin;Password=***;TrustServerCertificate=True;Encrypt=True;",
    "schemas": {
      "source": "new_data",
      "transition": "raw_data",
      "processing": "etl",
      "production": "dbo"
    },
    "pocMode": false
  },
  "inputFiles": {
    "premiums": "",
    "certificateInfo": "",
    "commissionsDetail": "",
    "individualBrokers": "",
    "orgBrokers": "",
    "licenses": "",
    "eo": "",
    "scheduleRates": "",
    "perfGroups": "",
    "fees": ""
  },
  "debugMode": {
    "enabled": false,
    "maxRecords": {
      "brokers": 100000,
      "groups": 100000,
      "policies": 1000000,
      "premiums": 10000000,
      "hierarchies": 100000,
      "proposals": 100000
    }
  },
  "resume": {
    "enabled": false,
    "resumeFromRunId": null
  }
}
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš ï¸  State tables not found - running without state tracking

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ETL Pipeline Run Started                                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  Run Name:    ETL-full-2026-01-28T19-07-33-119Z
  Run Type:    full
  Total Steps: 29
  Started:     2026-01-28T19:07:33.732Z


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“¦ Phase 1/6: Schema Setup
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

  [1/29] 00a-state-management-tables.sql (3.4%)
   âš¡ Executing 11 SQL batch(es)...
    âœ… 00a-state-management-tables.sql completed in 0.1s

  [2/29] 00-schema-setup.sql (6.9%)
   âš¡ Executing 5 SQL batch(es)...
    âœ… 00-schema-setup.sql completed (0 records) in 1.1s

  [3/29] 01-raw-tables.sql (10.3%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… 01-raw-tables.sql completed (0 records) in 0.3s

  [4/29] 02-input-tables.sql (13.8%)
   âš¡ Executing 6 SQL batch(es)...
    âœ… 02-input-tables.sql completed (1 records) in 1.1s

  [5/29] 03-staging-tables.sql (17.2%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… 03-staging-tables.sql completed (0 records) in 0.5s

  [6/29] 03a-prestage-tables.sql (20.7%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… 03a-prestage-tables.sql completed (0 records) in 0.3s

  [7/29] 03b-conformance-table.sql (24.1%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… 03b-conformance-table.sql completed (0 records) in 0.1s


âœ… Phase "Schema Setup" completed in 3.5s


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“¦ Phase 2/6: Data Ingest
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

  [8/29] copy-from-poc-etl.sql (27.6%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… copy-from-poc-etl.sql completed in 0.2s

  [9/29] populate-input-tables.sql (31.0%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… populate-input-tables.sql completed (0 records) in 0.2s


âœ… Phase "Data Ingest" completed in 0.3s


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“¦ Phase 3/6: Data Transforms
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

  [10/29] 00-references.sql (34.5%)
   âš¡ Executing 6 SQL batch(es)...
    âœ… 00-references.sql completed (1 records) in 0.9s

  [11/29] 01-brokers.sql (37.9%)
   âš¡ Executing 3 SQL batch(es)...
    âœ… 01-brokers.sql completed (0 records) in 0.5s

  [12/29] 02-groups.sql (41.4%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… 02-groups.sql completed (0 records) in 0.2s

  [13/29] 03-products.sql (44.8%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… 03-products.sql completed (0 records) in 0.2s

  [14/29] 04-schedules.sql (48.3%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… 04-schedules.sql completed (0 records) in 0.2s

  [15/29] 06a-proposals-simple-groups.sql (51.7%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… 06a-proposals-simple-groups.sql completed (0 records) in 0.2s

  [16/29] 06b-proposals-non-conformant.sql (55.2%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… 06b-proposals-non-conformant.sql completed (0 records) in 0.2s

  [17/29] 06c-proposals-plan-differentiated.sql (58.6%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… 06c-proposals-plan-differentiated.sql completed in 0.1s

  [18/29] 06d-proposals-year-differentiated.sql (62.1%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… 06d-proposals-year-differentiated.sql completed in 0.1s

  [19/29] 06e-proposals-granular.sql (65.5%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… 06e-proposals-granular.sql completed in 0.2s

  [20/29] 06f-populate-prestage-split-configs.sql (69.0%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… 06f-populate-prestage-split-configs.sql completed (0 records) in 0.2s

  [21/29] 06g-normalize-proposal-date-ranges.sql (72.4%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… 06g-normalize-proposal-date-ranges.sql completed (0 records) in 0.2s

  [22/29] 06z-update-proposal-broker-names.sql (75.9%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… 06z-update-proposal-broker-names.sql completed (0 records) in 0.2s

  [23/29] 07-hierarchies.sql (79.3%)
   âš¡ Executing 10 SQL batch(es)...
    âœ… 07-hierarchies.sql completed in 0.1s

  [24/29] 08-analyze-conformance.sql (82.8%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… 08-analyze-conformance.sql completed (0 records) in 1.0s

  [25/29] 08-hierarchy-splits.sql (86.2%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… 08-hierarchy-splits.sql completed (0 records) in 0.2s

  [26/29] 09-policies.sql (89.7%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… 09-policies.sql completed (0 records) in 0.2s

  [27/29] 10-premium-transactions.sql (93.1%)
   âš¡ Executing 2 SQL batch(es)...
    âœ… 10-premium-transactions.sql completed (1 records) in 0.4s

  [28/29] 11-policy-hierarchy-assignments.sql (96.6%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… 11-policy-hierarchy-assignments.sql completed (0 records) in 0.2s

  [29/29] 99-audit-and-cleanup.sql (100.0%)
   âš¡ Executing 1 SQL batch(es)...
    âœ… 99-audit-and-cleanup.sql completed in 0.1s


âœ… Phase "Data Transforms" completed in 5.6s


ğŸ”„ Running proposal consolidation...

ğŸ”„ Starting proposal consolidation...
   Using schema: etl
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¥ Step 1: Loading pre-stage proposals...
   âœ“ Loaded 0 pre-stage proposals

ğŸ”€ Step 2: Sorting proposals...
   âœ“ Proposals sorted by GroupId â†’ EffectiveDateFrom â†’ SplitConfigurationMD5

ğŸ”¨ Step 3: Running iterative consolidation algorithm...
   âœ“ Consolidated: 0 retained, 0 consumed

ğŸ’¾ Step 4: Updating pre-stage with consolidation flags...
   âœ“ Updated 0 retained proposals
   âœ“ Updated 0 consumed proposals

ğŸ“¤ Step 5: Copying retained proposals to staging...
   âœ“ Copied 0 proposals to staging

ğŸ·ï¸  Step 5.5: Assigning display names...
   âœ“ Assigned display names to 0 proposals

ğŸ—ï¸  Step 6: Copying hierarchies to staging...
   âœ“ Copied 0 hierarchies
   âœ“ Copied 0 hierarchy versions
   âœ“ Copied 0 hierarchy participants

ğŸ“‹ Step 7: Copying split versions and participants...
   âœ“ Copied 0 split versions
   âœ“ Copied 0 split participants

â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
âœ… Consolidation complete!

âœ“ Consolidation completed in 2.14s


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ETL Pipeline Run Completed                                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  Steps Completed: 29
  Total Duration:  11.6s
  Started:         2026-01-28T19:07:33.732Z
  Completed:       2026-01-28T19:07:45.304Z

